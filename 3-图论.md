# 图论

## 树上问题  

### 求LCA  

```cpp
namespace Tree {
	int siz[N], mson[N], ltp[N], fa[N], dth[N];
	vector<int> son[N];
	void dfs1(int x, int pre) {
		siz[x] = 1;
		mson[x] = 0;
		fa[x] = pre;
		dth[x] = dth[pre] + 1;
		for(auto y : son[x]) if(y != pre) {
			dfs1(y, x);
			if(mson[x] == 0 || siz[y] > siz[mson[x]]) mson[x] = y;
		}
	}
	void dfs2(int x, int pre, int tp) {
		ltp[x] = tp;
		if(mson[x]) dfs2(mson[x], x, tp);
		for(auto y : son[x]) if(y != pre && y != mson[x]) {
			dfs2(y, x, y);
		}
	}
	void init() {
		dfs1(1, 0);
		dfs2(1, 0, 1);
	}
	int LCA(int x, int y) {
		while(ltp[x] != ltp[y]) {
			if(dth[ltp[x]] > dth[ltp[y]]) x = fa[ltp[x]];
			else y = fa[ltp[y]];
		}
		return dth[y] > dth[x] ? x : y;
	}
}
```

